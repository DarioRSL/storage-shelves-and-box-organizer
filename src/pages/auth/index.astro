---
import Layout from "@/layouts/Layout.astro";
import { AuthLayout } from "@/components/AuthLayout";

// Disable prerendering for auth routes
export const prerender = false;

// Get current route from URL
const { pathname } = Astro.url;
const isRegisterPage = pathname.includes("/register");
const initialMode = isRegisterPage ? "register" : "login";

// Check if user is already authenticated
const user = Astro.locals.user;
if (user) {
  return Astro.redirect("/app");
}

// Auth page always uses light theme
const themePreference = "light";
---

<Layout title="Logowanie - Organizator" themePreference={themePreference}>
  <div transition:animate="fade" class="view-transition-name-auth-page">
    <AuthLayout client:load initialMode={initialMode} />
  </div>
</Layout>

<style>
  :global {
    @view-transition {
      navigation: auto;
    }
  }
</style>
